{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.3", "generated_at": "2023-12-10T19:57:17.523157Z", "invocation_id": "fa40a0d5-a5c0-4c87-ae80-b75b95746df3", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-10T19:57:16.902680Z", "completed_at": "2023-12-10T19:57:16.921245Z"}, {"name": "execute", "started_at": "2023-12-10T19:57:16.923816Z", "completed_at": "2023-12-10T19:57:17.127962Z"}], "thread_id": "Thread-1", "execution_time": 0.23065495491027832, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.de_test.task1", "compiled": true, "compiled_code": "\n\nWITH rank_payments AS (\n  SELECT\n    client_name\n  , payment_date\n  , value\n  , RANK() OVER (PARTITION BY client_id ORDER BY value DESC) rnk\n  FROM payments\n  WHERE payment_date BETWEEN '2023-01-01' AND '2023-01-31'\n)\nSELECT\n  client_name\n, payment_date\n, value\nFROM rank_payments\nWHERE rnk = 1\nORDER BY client_name", "relation_name": "`dedb`.`task1`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-10T19:57:17.139921Z", "completed_at": "2023-12-10T19:57:17.147206Z"}, {"name": "execute", "started_at": "2023-12-10T19:57:17.150231Z", "completed_at": "2023-12-10T19:57:17.228177Z"}], "thread_id": "Thread-1", "execution_time": 0.09312725067138672, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.de_test.task2", "compiled": true, "compiled_code": "\n\nWITH mds AS (\n\tSELECT LEFT(email, 1) || SUBSTRING(email, 3, LENGTH(email)-1) email, department\n\tFROM manager_departments\n)\nSELECT COALESCE(mds.department, '\u041e\u0442\u0434\u0435\u043b \u043d\u0435 \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d') department, SUM(p.value) \"sum\"\nFROM payments p\nLEFT JOIN mds ON p.manager_email = mds.email\nGROUP BY mds.department", "relation_name": "`dedb`.`task2`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-10T19:57:17.241970Z", "completed_at": "2023-12-10T19:57:17.249875Z"}, {"name": "execute", "started_at": "2023-12-10T19:57:17.252935Z", "completed_at": "2023-12-10T19:57:17.333112Z"}], "thread_id": "Thread-1", "execution_time": 0.09627199172973633, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.de_test.task3", "compiled": true, "compiled_code": "\n\nWITH rank_data AS (\n\tSELECT\n\t  id\n\t, value\n\t, client_id\n\t, client_name\n\t, payment_date\n\t, manager_name\n\t, manager_email\n\t, RANK() OVER (PARTITION BY client_id ORDER BY payment_date, id) rnk\n\tFROM payments\n)\nSELECT\n  id\n, value\n, client_id\n, client_name\n, payment_date\n, manager_name\n, manager_email\n, if(rnk = 1, '\u041d\u043e\u0432\u044b\u0439', '\u0414\u0435\u0439\u0441\u0442\u0432\u0443\u044e\u0449\u0438\u0439') client_state\nFROM rank_data", "relation_name": "`dedb`.`task3`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-10T19:57:17.345296Z", "completed_at": "2023-12-10T19:57:17.353270Z"}, {"name": "execute", "started_at": "2023-12-10T19:57:17.356092Z", "completed_at": "2023-12-10T19:57:17.506810Z"}], "thread_id": "Thread-1", "execution_time": 0.1665043830871582, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.de_test.task4", "compiled": true, "compiled_code": "\n\nWITH group_data AS(\n\tSELECT\n\t  toMonth(payment_date) tmonth\n\t, toYear(payment_date) tyear\n\t, SUM(value) revenue_by_month\n\tFROM payments\n\tGROUP BY tmonth, tyear\n)\n, months_name AS(\n\tSELECT 1 tmonth, '\u042f\u043d\u0432\u0430\u0440\u044c' name UNION ALL\n\tSELECT 2, '\u0424\u0435\u0432\u0440\u0430\u043b\u044c'\t\tUNION ALL\n\tSELECT 3, '\u041c\u0430\u0440\u0442'\t\tUNION ALL\n\tSELECT 4, '\u0410\u043f\u0440\u0435\u043b\u044c' \t\tUNION ALL\n\tSELECT 5, '\u041c\u0430\u0439' \t\tUNION ALL\n\tSELECT 6, '\u0418\u044e\u043d\u044c' \t\tUNION ALL\n\tSELECT 7, '\u0418\u044e\u043b\u044c' \t\tUNION ALL\n\tSELECT 8, '\u0410\u0432\u0433\u0443\u0441\u0442' \t\tUNION ALL\n\tSELECT 9, '\u0421\u0435\u043d\u0442\u044f\u0431\u0440\u044c' \tUNION ALL\n\tSELECT 10, '\u041e\u043a\u0442\u044f\u0431\u0440\u044c' \tUNION ALL\n\tSELECT 11, '\u041d\u043e\u044f\u0431\u0440\u044c'\t\tUNION ALL\n\tSELECT 12, '\u0414\u0435\u043a\u0430\u0431\u0440\u044c'\n)\nSELECT mn.name || ' ' || toString(gd.tyear) \"period\"\n, revenue_by_month\n, SUM(revenue_by_month) OVER w revenue_cumulative\nFROM group_data gd\nINNER JOIN months_name mn ON gd.tmonth = mn.tmonth\nWINDOW w AS (\n  PARTITION BY gd.tyear\n  ORDER BY gd.tmonth\n  ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW\n)", "relation_name": "`dedb`.`task4`"}], "elapsed_time": 0.8136801719665527, "args": {"project_dir": "/home/nina/DE_test/de_test", "quiet": false, "vars": {}, "cache_selected_only": false, "macro_debugging": false, "log_path": "/home/nina/DE_test/de_test/logs", "printer_width": 80, "version_check": true, "populate_cache": true, "log_format": "default", "use_colors_file": true, "invocation_command": "dbt run", "defer": false, "strict_mode": false, "write_json": true, "partial_parse": true, "send_anonymous_usage_stats": true, "static_parser": true, "partial_parse_file_diff": true, "use_colors": true, "exclude": [], "favor_state": false, "indirect_selection": "eager", "show_resource_report": false, "which": "run", "log_level": "info", "log_level_file": "debug", "enable_legacy_logger": false, "profiles_dir": "/home/nina/DE_test/de_test", "warn_error_options": {"include": [], "exclude": []}, "introspect": true, "log_file_max_bytes": 10485760, "print": true, "log_format_file": "debug", "select": []}}